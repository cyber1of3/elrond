#!/usr/bin/env python3 -tt
def doXML(sd): # unfinished dashboard panels: Analysis & IOCs (own dashboard?), timeline
  # Initial Access
    with open(sd+"t1189.xml", "w") as t1189xml:
        t1189xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1189: Drive-by Compromise</label>\n  ")
        t1189xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1189xml.write("| search mitre_id=\"T1189\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1189xml.write("<html depends=\"$it_tok$\" src=\"t1189.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1189xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1189xml.write("| search mitre_id=\"T1189\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1189xml.write("<title>Browser activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=browser | `MITRE_lookup` ")
        t1189xml.write("| `browser_name` | `browser_domain` | table index host logtype LastWriteTime browser Domain url title Profile Protocol | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1189xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1190.xml", "w") as t1190xml: # undetectable
        t1190xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1190: Exploit Public-Facing Application</label>\n  ")
        t1190xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1190xml.write("| search mitre_id=\"T1190\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1190xml.write("<html depends=\"$it_tok$\" src=\"t1190.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1133.xml", "w") as t1133xml:
        t1133xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1133: External Remote Services</label>\n  ")
        t1133xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1133xml.write("| search mitre_id=\"T1133\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1133xml.write("<html depends=\"$it_tok$\" src=\"t1133.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1133xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1133xml.write("| search mitre_id=\"T1133\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1133xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1200.xml", "w") as t1200xml:
        t1200xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1200: Hardware Additions</label>\n  ")
        t1200xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1200xml.write("| search mitre_id=\"T1200\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1200xml.write("<html depends=\"$it_tok$\" src=\"t1200.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1200xml.write("<title>Windows USB Connectivity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique=$mitre_tok$ `usb_out`</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1200xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1566.xml", "w") as t1566xml:
        t1566xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1566: Phishing</label>\n  ")
        t1566xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1566xml.write("| search mitre_id=\"T1203\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1566xml.write("<html depends=\"$it_tok$\" src=\"t1203.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1566xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1566xml.write("| search mitre_id=\"T1203\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n      ")
        t1566xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1566xml.write("| search mitre_id=\"T1203\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n     ")
        t1566xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1566xml.write("| search mitre_id=\"T1203\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1566xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1091.xml", "w") as t1091xml:
        t1091xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1091: Replication Through Removable Media</label>\n  ")
        t1091xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1091xml.write("| search mitre_id=\"T1091\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1091xml.write("<html depends=\"$it_tok$\" src=\"t1091.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1091xml.write("<title>Windows USB Connectivity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique=$mitre_tok$ `usb_out`</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1091xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1195.xml", "w") as t1195xml: # undetectable
        t1195xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1195: Supply Chain Compromise</label>\n  ")
        t1195xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1195xml.write("| search mitre_id=\"T1195\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1195xml.write("<html depends=\"$it_tok$\" src=\"t1195.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1199.xml", "w") as t1199xml: # undetectable
        t1199xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1199: Trusted Relationship</label>\n  ")
        t1199xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1199xml.write("| search mitre_id=\"T1199\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1199xml.write("<html depends=\"$it_tok$\" src=\"t1199.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1078.xml", "w") as t1078xml:
        t1078xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1078: Valid Accounts</label>\n  ")
        t1078xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1078xml.write("| search mitre_id=\"T1078\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1078xml.write("<html depends=\"$it_tok$\" src=\"t1078.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1078xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1078xml.write("| search mitre_id=\"T1078\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1078xml.write("\n    </panel>\n  </row>\n</form>")
  # Execution
    with open(sd+"t1059.xml", "w") as t1059xml:
        t1059xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1059: Command and Scripting Interpreter</label>\n  ")
        t1059xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1059xml.write("| search mitre_id=\"T1059\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1059xml.write("<html depends=\"$it_tok$\" src=\"t1059.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1059xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1059xml.write("| search mitre_id=\"T1059\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1059xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1059xml.write("| search mitre_id=\"T1059\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n      ")
        t1059xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1059xml.write("| search mitre_id=\"T1059\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1059xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1059xml.write("| search mitre_id=\"T1059\" | table index host mitre_id subid mitre_technique LastWriteTime logtype ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1059xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1059xml.write("| search mitre_id=\"T1059\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n     ")
        t1059xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1059xml.write("| search mitre_id=\"T1059\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1059xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1059xml.write("| search mitre_id=\"T1059\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1059xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1609.xml", "w") as t1609xml:
        t1609xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1609: Container Administration Command</label>\n  ")
        t1609xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1609xml.write("| search mitre_id=\"T1609\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1609xml.write("<html depends=\"$it_tok$\" src=\"t1609.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1610.xml", "w") as t1610xml:
        t1610xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1610: Deploy Container</label>\n  ")
        t1610xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1610xml.write("| search mitre_id=\"T1610\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1610xml.write("<html depends=\"$it_tok$\" src=\"t1610.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1203.xml", "w") as t1203xml:
        t1203xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1203: Exploitation for Client Execution</label>\n  ")
        t1203xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1203xml.write("| search mitre_id=\"T1203\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1203xml.write("<html depends=\"$it_tok$\" src=\"t1203.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1203xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1203xml.write("| search mitre_id=\"T1203\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1203xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1203xml.write("| search mitre_id=\"T1203\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n      ")
        t1203xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1203xml.write("| search mitre_id=\"T1203\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1203xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1203xml.write("| search mitre_id=\"T1203\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1203xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1203xml.write("| search mitre_id=\"T1203\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n     ")
        t1203xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1203xml.write("| search mitre_id=\"T1203\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>")
        t1203xml.write("\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1203xml.write("<title>Browser activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=browser | `MITRE_lookup` ")
        t1203xml.write("| `browser_name` | `browser_domain` | table index host logtype LastWriteTime browser Domain url title Profile Protocol | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1203xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1203xml.write("| search mitre_id=\"T1203\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1203xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1559.xml", "w") as t1559xml:
        t1559xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1559: Inter-Process Communication</label>\n  ")
        t1559xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1559xml.write("| search mitre_id=\"T1559\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1559xml.write("<html depends=\"$it_tok$\" src=\"t1559.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1559xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1559xml.write("| search mitre_id=\"T1559\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1559xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1559xml.write("| search mitre_id=\"T1559\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1559xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1559xml.write("| search mitre_id=\"T1559\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1559xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1559xml.write("| search mitre_id=\"T1559\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1559xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1559xml.write("| search mitre_id=\"T1559\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1559xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1106.xml", "w") as t1106xml:
        t1106xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1106: Native API</label>\n  ")
        t1106xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1106xml.write("| search mitre_id=\"T1106\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1106xml.write("<html depends=\"$it_tok$\" src=\"t1106.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1106xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1106xml.write("| search mitre_id=\"T1106\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1106xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1106xml.write("| search mitre_id=\"T1106\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1106xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1106xml.write("| search mitre_id=\"T1559\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1106xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1106xml.write("| search mitre_id=\"T1106\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1106xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1106xml.write("| search mitre_id=\"T1106\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1106xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1106xml.write("| search mitre_id=\"T1106\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1106xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1106xml.write("| search mitre_id=\"T1106\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1106xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1053.xml", "w") as t1053xml:
        t1053xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1053: Scheduled Task/Job</label>\n  ")
        t1053xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1053xml.write("| search mitre_id=\"T1053\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1053xml.write("<html depends=\"$it_tok$\" src=\"t1053.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1053xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1053xml.write("| search mitre_id=\"T1053\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1053xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1053xml.write("| search mitre_id=\"T1053\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1053xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1053xml.write("| search mitre_id=\"T1053\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1053xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1053xml.write("| search mitre_id=\"T1053\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1053xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1053xml.write("| search mitre_id=\"T1053\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1053xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1053xml.write("| search mitre_id=\"T1053\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1053xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1053xml.write("| search mitre_id=\"T1053\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1053xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1129.xml", "w") as t1129xml: # no events available
        t1129xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1129: Shared Modules</label>\n  ")
        t1129xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1129xml.write("| search mitre_id=\"T1129\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1129xml.write("<html depends=\"$it_tok$\" src=\"t1129.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1072.xml", "w") as t1072xml: # no events available
        t1072xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1072: Software Deployment Tools</label>\n  ")
        t1072xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1072xml.write("| search mitre_id=\"T1072\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1072xml.write("<html depends=\"$it_tok$\" src=\"t1072.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1569.xml", "w") as t1569xml:
        t1569xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1569: System Services</label>\n  ")
        t1569xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1569xml.write("| search mitre_id=\"T1569\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1569xml.write("<html depends=\"$it_tok$\" src=\"t1569.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1569xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1569xml.write("| search mitre_id=\"T1569\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1569xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1569xml.write("| search mitre_id=\"T1569\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1569xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1569xml.write("| search mitre_id=\"T1569\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1569xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1569xml.write("| search mitre_id=\"T1569\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1569xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1569xml.write("| search mitre_id=\"T1569\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1569xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1569xml.write("| search mitre_id=\"T1569\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1569xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1569xml.write("| search mitre_id=\"T1569\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1569xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1204.xml", "w") as t1204xml:
        t1204xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1204: User Execution</label>\n  ")
        t1204xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1204xml.write("| search mitre_id=\"T1204\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1204xml.write("<html depends=\"$it_tok$\" src=\"t1204.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1204xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1204xml.write("| search mitre_id=\"T1204\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1204xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1204xml.write("| search mitre_id=\"T1204\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n      ")
        t1204xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1204xml.write("| search mitre_id=\"T1204\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1204xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1204xml.write("| search mitre_id=\"T1204\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1204xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1204xml.write("| search mitre_id=\"T1204\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n     ")
        t1204xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1204xml.write("| search mitre_id=\"T1204\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>")
        t1204xml.write("\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1204xml.write("<title>Browser activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=browser | `MITRE_lookup` ")
        t1204xml.write("| `browser_name` | `browser_domain` | table index host logtype LastWriteTime browser Domain url title Profile Protocol | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1204xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1204xml.write("| search mitre_id=\"T1204\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1204xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1047.xml", "w") as t1047xml:
        t1047xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1047: Windows Management Instrumentation</label>\n  ")
        t1047xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1047xml.write("| search mitre_id=\"T1047\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1047xml.write("<html depends=\"$it_tok$\" src=\"t1047.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1047xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1047xml.write("| search mitre_id=\"T1047\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1047xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1047xml.write("| search mitre_id=\"T1047\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1047xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1047xml.write("| search mitre_id=\"T1047\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1047xml.write("\n    </panel>\n  </row>\n</form>")
  # Persistence - unfinished: 1 custom
    with open(sd+"t1098.xml", "w") as t1098xml:
        t1098xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1098: Account Manipulation</label>\n  ")
        t1098xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1098xml.write("| search mitre_id=\"T1098\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1098xml.write("<html depends=\"$it_tok$\" src=\"t1098.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1098xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1098xml.write("| search mitre_id=\"T1098\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1098xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1098xml.write("| search mitre_id=\"T1098\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1098xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1098xml.write("| search mitre_id=\"T1098\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1098xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1197.xml", "w") as t1197xml:
        t1197xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1197: BITS Jobs</label>\n  ")
        t1197xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1197xml.write("| search mitre_id=\"T1197\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1197xml.write("<html depends=\"$it_tok$\" src=\"t1197.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1197xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1197xml.write("| search mitre_id=\"T1197\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1197xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1547.xml", "w") as t1547xml:
        t1547xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1547: Boot or Logon Autostart Execution</label>\n  ")
        t1547xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1547xml.write("| search mitre_id=\"T1547\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1547xml.write("<html depends=\"$it_tok$\" src=\"t1547.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1547xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1547xml.write("| search mitre_id=\"T1547\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1547xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1547xml.write("| search mitre_id=\"T1547\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1547xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1547xml.write("| search mitre_id=\"T1547\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n      <table>\n        ")
        t1547xml.write("<title>Registry activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=registry | `MITRE_lookup` ")
        t1547xml.write("| search mitre_id=\"T1547\" RegistryKey=* | table index host mitre_id subid mitre_technique logtype Plugin AccountProfile RegistryHive RegistryKey CommandParameters</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1547xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1547xml.write("| search mitre_id=\"T1547\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1547xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1547xml.write("| search mitre_id=\"T1547\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1547xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1547xml.write("| search mitre_id=\"T1547\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1547xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1547xml.write("| search mitre_id=\"T1547\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1547xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1547xml.write("| search mitre_id=\"T1547\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1547xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1037.xml", "w") as t1037xml:
        t1037xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1037: Boot or Logon Initialization Scripts</label>\n  ")
        t1037xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1037xml.write("| search mitre_id=\"T1037\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1037xml.write("<html depends=\"$it_tok$\" src=\"t1037.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1037xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1037xml.write("| search mitre_id=\"T1037\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1037xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1037xml.write("| search mitre_id=\"T1037\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1037xml.write("<title>Registry activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=registry | `MITRE_lookup` ")
        t1037xml.write("| search mitre_id=\"T1037\" RegistryKey=* | table index host mitre_id subid mitre_technique logtype Plugin AccountProfile RegistryHive RegistryKey CommandParameters</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1037xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1037xml.write("| search mitre_id=\"T1037\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1037xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1037xml.write("| search mitre_id=\"T1037\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1037xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1037xml.write("| search mitre_id=\"T1037\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1037xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1037xml.write("| search mitre_id=\"T1037\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1037xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1176.xml", "w") as t1176xml:
        t1176xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1176: Browser Extensions</label>\n  ")
        t1176xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1176xml.write("| search mitre_id=\"T1176\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1176xml.write("<html depends=\"$it_tok$\" src=\"t1176.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1176xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1176xml.write("| search mitre_id=\"T1176\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1176xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1176xml.write("| search mitre_id=\"T1176\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1176xml.write("<title>Browser activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=browser | `MITRE_lookup` ")
        t1176xml.write("| `browser_name` | `browser_domain` | table index host logtype LastWriteTime browser Domain url title Profile Protocol | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1176xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1554.xml", "w") as t1554xml: # undetectable
        t1554xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1554: Compromise Client Software Binary</label>\n  ")
        t1554xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1554xml.write("| search mitre_id=\"T1554\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1554xml.write("<html depends=\"$it_tok$\" src=\"t1554.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1136.xml", "w") as t1136xml:
        t1136xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1136: Create Account</label>\n  ")
        t1136xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1136xml.write("| search mitre_id=\"T1136\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1136xml.write("<html depends=\"$it_tok$\" src=\"t1136.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1136xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1136xml.write("| search mitre_id=\"T1136\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1136xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1136xml.write("| search mitre_id=\"T1136\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n      <table>\n        ")
        t1136xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1136xml.write("| search mitre_id=\"T1136\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1136xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1543.xml", "w") as t1543xml:
        t1543xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1543: Create or Modify System Process</label>\n  ")
        t1543xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1543xml.write("| search mitre_id=\"T1543\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1543xml.write("<html depends=\"$it_tok$\" src=\"t1543.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1543xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1543xml.write("| search mitre_id=\"T1543\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1543xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1543xml.write("| search mitre_id=\"T1543\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1543xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1543xml.write("| search mitre_id=\"T1543\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1543xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1543xml.write("| search mitre_id=\"T1543\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1543xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1543xml.write("| search mitre_id=\"T1543\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1543xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1543xml.write("| search mitre_id=\"T1543\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1543xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1543xml.write("| search mitre_id=\"T1543\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1543xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1546.xml", "w") as t1546xml:
        t1546xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1546: Event Triggered Execution</label>\n  ")
        t1546xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1546xml.write("| search mitre_id=\"T1546\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1546xml.write("<html depends=\"$it_tok$\" src=\"t1546.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1546xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1546xml.write("| search mitre_id=\"T1546\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1546xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1546xml.write("| search mitre_id=\"T1546\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1546xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1546xml.write("| search mitre_id=\"T1546\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1546xml.write("<title>Registry activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=registry | `MITRE_lookup` ")
        t1546xml.write("| search mitre_id=\"T1546\" RegistryKey=* | table index host mitre_id subid mitre_technique logtype Plugin AccountProfile RegistryHive RegistryKey CommandParameters</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1546xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1546xml.write("| search mitre_id=\"T1546\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1546xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1546xml.write("| search mitre_id=\"T1546\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1546xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1546xml.write("| search mitre_id=\"T1546\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1546xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1546xml.write("| search mitre_id=\"T1546\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1546xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1574.xml", "w") as t1574xml: # custom - paths with spaces in and not wrapped in quotes - need memory and evt logs
        t1574xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1574: Hijack Execution Flow</label>\n  ")
        t1574xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1574xml.write("| search mitre_id=\"T1574\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1574xml.write("<html depends=\"$it_tok$\" src=\"t1574.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1574xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1574xml.write("| search mitre_id=\"T1574\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1574xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1574xml.write("| search mitre_id=\"T1574\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1574xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1574xml.write("| search mitre_id=\"T1574\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1574xml.write("<title>Registry activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=registry | `MITRE_lookup` ")
        t1574xml.write("| search mitre_id=\"T1574\" RegistryKey=* | table index host mitre_id subid mitre_technique logtype Plugin AccountProfile RegistryHive RegistryKey CommandParameters</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1574xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1574xml.write("| search mitre_id=\"T1574\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>0</earliest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1574xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1574xml.write("| search mitre_id=\"T1574\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1574xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1574xml.write("| search mitre_id=\"T1574\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1574xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1574xml.write("| search mitre_id=\"T1574\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1574xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1525.xml", "w") as t1525xml: # out of scope
        t1525xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1525: Implant Container Image</label>\n  ")
        t1525xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1525xml.write("| search mitre_id=\"T1525\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1525xml.write("<html depends=\"$it_tok$\" src=\"t1525.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1556.xml", "w") as t1556xml:
        t1556xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1556: Modify Authentication Process</label>\n  ")
        t1556xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1556xml.write("| search mitre_id=\"T1556\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1556xml.write("<html depends=\"$it_tok$\" src=\"t1556.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1556xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1556xml.write("| search mitre_id=\"T1556\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1556xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1556xml.write("| search mitre_id=\"T1556\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1556xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1556xml.write("| search mitre_id=\"T1556\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1556xml.write("<title>Registry activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=registry | `MITRE_lookup` ")
        t1556xml.write("| search mitre_id=\"T1556\" RegistryKey=* | table index host mitre_id subid mitre_technique logtype Plugin AccountProfile RegistryHive RegistryKey CommandParameters</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1556xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1556xml.write("| search mitre_id=\"T1556\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1556xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1556xml.write("| search mitre_id=\"T1556\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1556xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1556xml.write("| search mitre_id=\"T1556\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1556xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1556xml.write("| search mitre_id=\"T1556\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1556xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1556xml.write("| search mitre_id=\"T1556\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1556xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1137.xml", "w") as t1137xml:
        t1137xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1137: Office Application Startup</label>\n  ")
        t1137xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1137xml.write("| search mitre_id=\"T1137\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1137xml.write("<html depends=\"$it_tok$\" src=\"t1137.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1137xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1137xml.write("| search mitre_id=\"T1137\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1137xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1137xml.write("| search mitre_id=\"T1137\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1137xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1542.xml", "w") as t1542xml: # undetectable
        t1542xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1542: Pre-OS Boot</label>\n  ")
        t1542xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1542xml.write("| search mitre_id=\"T1542\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1542xml.write("<html depends=\"$it_tok$\" src=\"t1542.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1505.xml", "w") as t1505xml: # undetectable
        t1505xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1505: Server Software Component</label>\n  ")
        t1505xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1505xml.write("| search mitre_id=\"T1505\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1505xml.write("<html depends=\"$it_tok$\" src=\"t1505.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1205.xml", "w") as t1205xml: # undetectable
        t1205xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1205: Traffic Signaling</label>\n  ")
        t1205xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1205xml.write("| search mitre_id=\"T1205\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1205xml.write("<html depends=\"$it_tok$\" src=\"t1205.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
  # Privilege Escalation
    with open(sd+"t1548.xml", "w") as t1548xml:
        t1548xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1548: Abuse Elevation Control Mechanism</label>\n  ")
        t1548xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1548xml.write("| search mitre_id=\"T1548\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1548xml.write("<html depends=\"$it_tok$\" src=\"t1548.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1548xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1548xml.write("| search mitre_id=\"T1548\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1548xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1548xml.write("| search mitre_id=\"T1548\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1548xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1548xml.write("| search mitre_id=\"T1548\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1548xml.write("<title>Registry activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=registry | `MITRE_lookup` ")
        t1548xml.write("| search mitre_id=\"T1548\" RegistryKey=* | table index host mitre_id subid mitre_technique logtype Plugin AccountProfile RegistryHive RegistryKey CommandParameters</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1548xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1548xml.write("| search mitre_id=\"T1548\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1548xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1548xml.write("| search mitre_id=\"T1548\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1548xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1548xml.write("| search mitre_id=\"T1548\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1548xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1548xml.write("| search mitre_id=\"T1548\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1548xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1134.xml", "w") as t1134xml:
        t1134xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1134: Access Token Manipulation</label>\n  ")
        t1134xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1134xml.write("| search mitre_id=\"T1134\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1134xml.write("<html depends=\"$it_tok$\" src=\"t1134.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1134xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1134xml.write("| search mitre_id=\"T1134\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1134xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1484.xml", "w") as t1484xml:
        t1484xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1484: Group Policy Modification</label>\n  ")
        t1484xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1484xml.write("| search mitre_id=\"T1484\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1484xml.write("<html depends=\"$it_tok$\" src=\"t1484.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1484xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1484xml.write("| search mitre_id=\"T1484\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1484xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1484xml.write("| search mitre_id=\"T1484\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1484xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1484xml.write("| search mitre_id=\"T1484\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1484xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1484xml.write("| search mitre_id=\"T1484\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1484xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1611.xml", "w") as t1611xml: # undetectable
        t1611xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1611: Escape to Host</label>\n  ")
        t1611xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1611xml.write("| search mitre_id=\"T1611\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1611xml.write("<html depends=\"$it_tok$\" src=\"t1611.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1068.xml", "w") as t1068xml: # undetectable
        t1068xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1068: Exploitation for Privilege Escalation</label>\n  ")
        t1068xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1068xml.write("| search mitre_id=\"T1068\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1068xml.write("<html depends=\"$it_tok$\" src=\"t1068.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1055.xml", "w") as t1055xml:
        t1055xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1055: Process Injection</label>\n  ")
        t1055xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1055xml.write("| search mitre_id=\"T1055\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1055xml.write("<html depends=\"$it_tok$\" src=\"t1055.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1055xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1055xml.write("| search mitre_id=\"T1055\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1055xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1055xml.write("| search mitre_id=\"T1055\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1055xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1055xml.write("| search mitre_id=\"T1055\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1055xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1055xml.write("| search mitre_id=\"T1055\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1055xml.write("</panel>\n  </row>\n</form>")
  # Defense Evasion
    with open(sd+"t1612.xml", "w") as t1612xml:
        t1612xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1612: Build Image on Host</label>\n  ")
        t1612xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1612xml.write("| search mitre_id=\"T1612\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1612xml.write("<html depends=\"$it_tok$\" src=\"t1612.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1140.xml", "w") as t1140xml:
        t1140xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1140: Deobfuscate/Decode Files or Information</label>\n  ")
        t1140xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1140xml.write("| search mitre_id=\"T1140\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1140xml.write("<html depends=\"$it_tok$\" src=\"t1140.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1140xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1140xml.write("| search mitre_id=\"T1140\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1140xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1140xml.write("| search mitre_id=\"T1140\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1140xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1140xml.write("| search mitre_id=\"T1140\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1140xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1140xml.write("| search mitre_id=\"T1140\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1140xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1006.xml", "w") as t1006xml:
        t1006xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1006: Direct Volume Access</label>\n  ")
        t1006xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1006xml.write("| search mitre_id=\"T1006\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1006xml.write("<html depends=\"$it_tok$\" src=\"t1006.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1006xml.write("<title>Windows USB Connectivity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique=$mitre_tok$ `usb_out`</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1006xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1480.xml", "w") as t1480xml:
        t1480xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1480: Execution Guardrails</label>\n  ")
        t1480xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1480xml.write("| search mitre_id=\"T1480\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1480xml.write("<html depends=\"$it_tok$\" src=\"t1480.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1480xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1480xml.write("| search mitre_id=\"T1480\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1480xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1480xml.write("| search mitre_id=\"T1480\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1480xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1211.xml", "w") as t1211xml: # undetectable
        t1211xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1211: Exploitation for Defense Evasion</label>\n  ")
        t1211xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1211xml.write("| search mitre_id=\"T1211\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1211xml.write("<html depends=\"$it_tok$\" src=\"t1211.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1222.xml", "w") as t1222xml:
        t1222xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1222: File and Directory Permissions Modification</label>\n  ")
        t1222xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1222xml.write("| search mitre_id=\"T1222\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1222xml.write("<html depends=\"$it_tok$\" src=\"t1222.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1222xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1222xml.write("| search mitre_id=\"T1222\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1222xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1222xml.write("| search mitre_id=\"T1222\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1222xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1222xml.write("| search mitre_id=\"T1222\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1222xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1564.xml", "w") as t1564xml:
        t1564xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1564: Hide Artifacts</label>\n  ")
        t1564xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1564xml.write("| search mitre_id=\"T1564\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1564xml.write("<html depends=\"$it_tok$\" src=\"t1564.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1564xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1564xml.write("| search mitre_id=\"T1564\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1564xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1564xml.write("| search mitre_id=\"T1564\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1564xml.write("<title>Registry activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=registry | `MITRE_lookup` ")
        t1564xml.write("| search mitre_id=\"T1564\" RegistryKey=* | table index host mitre_id subid mitre_technique logtype Plugin AccountProfile RegistryHive RegistryKey CommandParameters</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1564xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1564xml.write("| search mitre_id=\"T1564\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n      <table>\n        ")
        t1564xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1564xml.write("| search mitre_id=\"T1564\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1564xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1564xml.write("| search mitre_id=\"T1564\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1564xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1564xml.write("| search mitre_id=\"T1564\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1564xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1564xml.write("| search mitre_id=\"T1564\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1564xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1564xml.write("| search mitre_id=\"T1564\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1564xml.write("<title>Windows USB Connectivity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique=$mitre_tok$ (\"vboxmanage\" OR \"virtualbox\" OR \"vmplayer\" OR \"vmware\" OR \"qemu\" OR \"hyper-v\" OR \"vmprocess\") `usb_out`</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1564xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1562.xml", "w") as t1562xml:
        t1562xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1562: Impair Defenses</label>\n  ")
        t1562xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1562xml.write("| search mitre_id=\"T1562\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1562xml.write("<html depends=\"$it_tok$\" src=\"t1562.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1562xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1562xml.write("| search mitre_id=\"T1562\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1562xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1562xml.write("| search mitre_id=\"T1562\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1562xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1562xml.write("| search mitre_id=\"T1562\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1562xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1070.xml", "w") as t1070xml:
        t1070xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1070: Indicator Removal on Host</label>\n  ")
        t1070xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1070xml.write("| search mitre_id=\"T1070\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1070xml.write("<html depends=\"$it_tok$\" src=\"t1070.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1070xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1070xml.write("| search mitre_id=\"T1070\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1070xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1070xml.write("| search mitre_id=\"T1070\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1070xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1070xml.write("| search mitre_id=\"T1070\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n      <table>\n        ")
        t1070xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1070xml.write("| search mitre_id=\"T1070\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1070xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1070xml.write("| search mitre_id=\"T1070\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1070xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1070xml.write("| search mitre_id=\"T1070\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1070xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1070xml.write("| search mitre_id=\"T1070\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1070xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1070xml.write("| search mitre_id=\"T1070\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1070xml.write("<title>Alternate Data Stream &amp; Extended Attributes analysis</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=analysis (AnalysisType=AlternateDataStream OR AnalysisType=ExtendedAttributes OR AnalysisType=Timestomp) | `merge_fileinfo` | dedup LastWriteTime Filename | table index host AnalysisType LastWriteTime Filepath Filename Fileext ")
        t1070xml.write("| fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1070xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1202.xml", "w") as t1202xml: # undetectable
        t1202xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1202: Indirect Command Execution</label>\n  ")
        t1202xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1202xml.write("| search mitre_id=\"T1202\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1202xml.write("<html depends=\"$it_tok$\" src=\"t1202.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1036.xml", "w") as t1036xml:
        t1036xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1036: Masquerading</label>\n  ")
        t1036xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1036xml.write("| search mitre_id=\"T1036\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1036xml.write("<html depends=\"$it_tok$\" src=\"t1036.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1036xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1036xml.write("| search mitre_id=\"T1036\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1036xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1036xml.write("| search mitre_id=\"T1036\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1036xml.write("<title>Registry activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=registry | `MITRE_lookup` ")
        t1036xml.write("| search mitre_id=\"T1036\" RegistryKey=* | table index host mitre_id subid mitre_technique logtype Plugin AccountProfile RegistryHive RegistryKey CommandParameters</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1036xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1036xml.write("| search mitre_id=\"T1036\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1036xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1036xml.write("| search mitre_id=\"T1036\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1036xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1036xml.write("| search mitre_id=\"T1036\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1036xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1578.xml", "w") as t1578xml: # out of scope
        t1578xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1578: Modify Cloud Compute Infrastructure</label>\n  ")
        t1578xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1578xml.write("| search mitre_id=\"T1578\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1578xml.write("<html depends=\"$it_tok$\" src=\"t1578.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1112.xml", "w") as t1112xml:
        t1112xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1112: Modify Registry</label>\n  ")
        t1112xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1112xml.write("| search mitre_id=\"T1112\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1112xml.write("<html depends=\"$it_tok$\" src=\"t1112.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1112xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1112xml.write("| search mitre_id=\"T1112\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1112xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1112xml.write("| search mitre_id=\"T1112\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1112xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1112xml.write("| search mitre_id=\"T1112\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n      <table>\n        ")
        t1112xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1112xml.write("| search mitre_id=\"T1112\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1112xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1112xml.write("| search mitre_id=\"T1112\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1112xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1601.xml", "w") as t1601xml: # undetectable
        t1601xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1601: Modify System Image</label>\n  ")
        t1601xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1601xml.write("| search mitre_id=\"T1601\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1601xml.write("<html depends=\"$it_tok$\" src=\"t1601.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1599.xml", "w") as t1599xml: # undetectable
        t1599xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1599: Network Boundary Bridging</label>\n  ")
        t1599xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1599xml.write("| search mitre_id=\"T1599\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1599xml.write("<html depends=\"$it_tok$\" src=\"t1599.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1027.xml", "w") as t1027xml:
        t1027xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1027: Obfuscated Files or Information</label>\n  ")
        t1027xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1027xml.write("| search mitre_id=\"T1027\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1027xml.write("<html depends=\"$it_tok$\" src=\"t1027.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1027xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1027xml.write("| search mitre_id=\"T1027\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1027xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1027xml.write("| search mitre_id=\"T1027\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1027xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1027xml.write("| search mitre_id=\"T1027\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1027xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1027xml.write("| search mitre_id=\"T1027\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1027xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1207.xml", "w") as t1207xml:
        t1207xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1207: Rogue Domain Controller</label>\n  ")
        t1207xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1207xml.write("| search mitre_id=\"T1207\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1207xml.write("<html depends=\"$it_tok$\" src=\"t1207.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1207xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1207xml.write("| search mitre_id=\"T1207\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1207xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1207xml.write("| search mitre_id=\"T1207\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1207xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1014.xml", "w") as t1014xml: # undetectable
        t1014xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1014: Rootkit</label>\n  ")
        t1014xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1014xml.write("| search mitre_id=\"T1014\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1014xml.write("<html depends=\"$it_tok$\" src=\"t1014.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1218.xml", "w") as t1218xml:
        t1218xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1218: Signed Binary Proxy Execution</label>\n  ")
        t1218xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1218xml.write("| search mitre_id=\"T1218\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1218xml.write("<html depends=\"$it_tok$\" src=\"t1218.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1218xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1218xml.write("| search mitre_id=\"T1218\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1218xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1218xml.write("| search mitre_id=\"T1218\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1218xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1218xml.write("| search mitre_id=\"T1218\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n      <table>\n        ")
        t1218xml.write("<title>Registry activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=registry | `MITRE_lookup` ")
        t1218xml.write("| search mitre_id=\"T1218\" RegistryKey=* | table index host mitre_id subid mitre_technique logtype Plugin AccountProfile RegistryHive RegistryKey CommandParameters</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1218xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1218xml.write("| search mitre_id=\"T1218\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1218xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1218xml.write("| search mitre_id=\"T1218\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1218xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1218xml.write("| search mitre_id=\"T1218\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1218xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1216.xml", "w") as t1216xml:
        t1216xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1216: Signed Script Proxy Execution</label>\n  ")
        t1216xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1216xml.write("| search mitre_id=\"T1216\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1216xml.write("<html depends=\"$it_tok$\" src=\"t1216.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1216xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1216xml.write("| search mitre_id=\"T1216\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1216xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1216xml.write("| search mitre_id=\"T1216\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1216xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1216xml.write("| search mitre_id=\"T1216\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1216xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1216xml.write("| search mitre_id=\"T1216\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1216xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1216xml.write("| search mitre_id=\"T1216\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1216xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1216xml.write("| search mitre_id=\"T1216\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1216xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1553.xml", "w") as t1553xml:
        t1553xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1553: Subvert Trust Controls</label>\n  ")
        t1553xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1553xml.write("| search mitre_id=\"T1553\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1553xml.write("<html depends=\"$it_tok$\" src=\"t1553.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1553xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1553xml.write("| search mitre_id=\"T1553\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1553xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1553xml.write("| search mitre_id=\"T1553\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1553xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1553xml.write("| search mitre_id=\"T1553\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1553xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1553xml.write("| search mitre_id=\"T1553\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1553xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1553xml.write("| search mitre_id=\"T1553\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1553xml.write("<title>Alternate Data Stream &amp; Extended Attributes analysis</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=analysis \"zone.identifier\" (AnalysisType=AlternateDataStream OR AnalysisType=ExtendedAttributes OR AnalysisType=Timestomp) | `merge_fileinfo` | dedup LastWriteTime Filename | table index host AnalysisType LastWriteTime Filepath Filename Fileext ")
        t1553xml.write("| fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1553xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1221.xml", "w") as t1221xml:
        t1221xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1221: Template Injection</label>\n  ")
        t1221xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1221xml.write("| search mitre_id=\"T1221\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1221xml.write("<html depends=\"$it_tok$\" src=\"t1221.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1221xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1221xml.write("| search mitre_id=\"T1221\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1221xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1221xml.write("| search mitre_id=\"T1221\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1221xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1127.xml", "w") as t1127xml:
        t1127xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1127: Trusted Developer Utilities Proxy Execution</label>\n  ")
        t1127xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1127xml.write("| search mitre_id=\"T1127\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1127xml.write("<html depends=\"$it_tok$\" src=\"t1127.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1127xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1127xml.write("| search mitre_id=\"T1127\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1127xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1535.xml", "w") as t1535xml: # out of scope
        t1535xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1535: Unused/Unsupported Cloud Regions</label>\n  ")
        t1535xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1535xml.write("| search mitre_id=\"T1535\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1535xml.write("<html depends=\"$it_tok$\" src=\"t1535.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1550.xml", "w") as t1550xml:
        t1550xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1550: Use Alternate Authentication Material</label>\n  ")
        t1550xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1550xml.write("| search mitre_id=\"T1550\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1550xml.write("<html depends=\"$it_tok$\" src=\"t1550.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1550xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1550xml.write("| search mitre_id=\"T1550\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1550xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1550xml.write("| search mitre_id=\"T1550\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1550xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1497.xml", "w") as t1497xml:
        t1497xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1497: Virtualization/Sandbox Evasion</label>\n  ")
        t1497xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1497xml.write("| search mitre_id=\"T1497\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1497xml.write("<html depends=\"$it_tok$\" src=\"t1497.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1497xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1497xml.write("| search mitre_id=\"T1497\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1497xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1497xml.write("| search mitre_id=\"T1497\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1497xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1497xml.write("| search mitre_id=\"T1497\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1497xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1497xml.write("| search mitre_id=\"T1497\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1497xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1600.xml", "w") as t1600xml: # undetectable
        t1600xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1600: Modify System Image</label>\n  ")
        t1600xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1600xml.write("| search mitre_id=\"T1600\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1600xml.write("<html depends=\"$it_tok$\" src=\"t1600.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1220.xml", "w") as t1220xml:
        t1220xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1220: XSL Script Processing</label>\n  ")
        t1220xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1220xml.write("| search mitre_id=\"T1220\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1220xml.write("<html depends=\"$it_tok$\" src=\"t1220.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1220xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1220xml.write("| search mitre_id=\"T1220\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1220xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1220xml.write("| search mitre_id=\"T1220\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1220xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1220xml.write("| search mitre_id=\"T1220\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1220xml.write("\n    </panel>\n  </row>\n</form>")
  # Credential Access
    with open(sd+"t1110.xml", "w") as t1110xml:
        t1110xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1110: Brute Force</label>\n  ")
        t1110xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1110xml.write("| search mitre_id=\"T1110\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1110xml.write("<html depends=\"$it_tok$\" src=\"t1110.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1110xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1110xml.write("| search mitre_id=\"T1110\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1110xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1110xml.write("| search mitre_id=\"T1110\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1110xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1110xml.write("| search mitre_id=\"T1110\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1110xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1555.xml", "w") as t1555xml:
        t1555xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1555: Credentials from Password Stores</label>\n  ")
        t1555xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1555xml.write("| search mitre_id=\"T1555\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1555xml.write("<html depends=\"$it_tok$\" src=\"t1555.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1555xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1555xml.write("| search mitre_id=\"T1555\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1555xml.write("<search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory (\"internet explorer\" OR \"internetexplorer\" OR \"edge\" OR \"chrome\" OR \"firefox\" OR \"safari\" OR \"brave\") AND \"password\" ")
        t1555xml.write("| stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1555xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1555xml.write("| search mitre_id=\"T1555\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1555xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1555xml.write("| search mitre_id=\"T1555\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1555xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1555xml.write("| search mitre_id=\"T1011\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1555xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1555xml.write("| search mitre_id=\"T1555\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1555xml.write("<title>Browser activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=browser | `MITRE_lookup` ")
        t1555xml.write("| `browser_name` | `browser_domain` | table index host logtype LastWriteTime browser Domain url title Profile Protocol | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1555xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1555xml.write("| search mitre_id=\"T1555\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1555xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1212.xml", "w") as t1212xml: # undetectable
        t1212xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1212: Exploitation for Credential Access</label>\n  ")
        t1212xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1212xml.write("| search mitre_id=\"T1212\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1212xml.write("<html depends=\"$it_tok$\" src=\"t1212.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1187.xml", "w") as t1187xml:
        t1187xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1187: Forced Authentication</label>\n  ")
        t1187xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1187xml.write("| search mitre_id=\"T1187\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1187xml.write("<html depends=\"$it_tok$\" src=\"t1187.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1187xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1187xml.write("| search mitre_id=\"T1187\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1187xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1606.xml", "w") as t1606xml:
        t1606xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1606: Forge Web Credentials</label>\n  ")
        t1606xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1606xml.write("| search mitre_id=\"T1606\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1606xml.write("<html depends=\"$it_tok$\" src=\"t1606.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1606xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1606xml.write("| search mitre_id=\"T1606\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1606xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1056.xml", "w") as t1056xml:
        t1056xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1056: Input Capture</label>\n  ")
        t1056xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1056xml.write("| search mitre_id=\"T1056\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1056xml.write("<html depends=\"$it_tok$\" src=\"t1056.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1056xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1056xml.write("| search mitre_id=\"T1056\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1056xml.write("<title>Windows USB Connectivity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique=$mitre_tok$ `usb_out`</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1056xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1557.xml", "w") as t1557xml:
        t1557xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1557: Man-in-the-Middle</label>\n  ")
        t1557xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1557xml.write("| search mitre_id=\"T1557\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1557xml.write("<html depends=\"$it_tok$\" src=\"t1557.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1557xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1557xml.write("| search mitre_id=\"T1557\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1557xml.write("<title>Registry activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=registry | `MITRE_lookup` ")
        t1557xml.write("| search mitre_id=\"T1557\" RegistryKey=* | table index host mitre_id subid mitre_technique logtype Plugin AccountProfile RegistryHive RegistryKey CommandParameters</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1557xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1557xml.write("| search mitre_id=\"T1557\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1557xml.write("<title>Browser activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=browser | `MITRE_lookup` ")
        t1557xml.write("| `browser_name` | `browser_domain` | table index host logtype LastWriteTime browser Domain url title Profile Protocol | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1557xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1040.xml", "w") as t1040xml: # undetectable
        t1040xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1040: Network Sniffing</label>\n  ")
        t1040xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1040xml.write("| search mitre_id=\"T1040\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1040xml.write("<html depends=\"$it_tok$\" src=\"t1040.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1003.xml", "w") as t1003xml:
        t1003xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1003: OS Credential Dumping</label>\n  ")
        t1003xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup`")
        t1003xml.write("| search mitre_id=\"T1003\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1003xml.write("<html depends=\"$it_tok$\" src=\"t1003.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1003xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1003xml.write("| search mitre_id=\"T1003\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1003xml.write("| <title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1003xml.write("| search mitre_id=\"T1003\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1003xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1003xml.write("| search mitre_id=\"T1003\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1003xml.write("<title>Registry activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=registry | `MITRE_lookup` ")
        t1003xml.write("| search mitre_id=\"T1003\" RegistryKey=* | table index host mitre_id subid mitre_technique logtype Plugin AccountProfile RegistryHive RegistryKey CommandParameters</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1003xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup`")
        t1003xml.write("| search mitre_id=\"T1003\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1003xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1003xml.write("| search mitre_id=\"T1003\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1003xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1003xml.write("| search mitre_id=\"T1003\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1003xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1003xml.write("| search mitre_id=\"T1003\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1003xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1528.xml", "w") as t1528xml: # undetectable
        t1528xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1528: Steal Application Access Token</label>\n  ")
        t1528xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1528xml.write("| search mitre_id=\"T1528\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1528xml.write("<html depends=\"$it_tok$\" src=\"t1528.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1558.xml", "w") as t1558xml:
        t1558xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1558: Steal or Forge Kerberos Tickets</label>\n  ")
        t1558xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1558xml.write("| search mitre_id=\"T1558\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1558xml.write("<html depends=\"$it_tok$\" src=\"t1558.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1558xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1558xml.write("| search mitre_id=\"T1558\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1558xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1539.xml", "w") as t1539xml: # undetectable
        t1539xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1539: Steal Web Session Cookie</label>\n  ")
        t1539xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1539xml.write("| search mitre_id=\"T1539\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1539xml.write("<html depends=\"$it_tok$\" src=\"t1539.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1111.xml", "w") as t1111xml: # undetectable
        t1111xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1111: Two-Factor Authentication Interception</label>\n  ")
        t1111xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1111xml.write("| search mitre_id=\"T1111\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1111xml.write("<html depends=\"$it_tok$\" src=\"t1111.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1552.xml", "w") as t1552xml:
        t1552xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1552: Unsecured Credentials</label>\n  ")
        t1552xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1552xml.write("| search mitre_id=\"T1552\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1552xml.write("<html depends=\"$it_tok$\" src=\"t1552.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1552xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1552xml.write("| search mitre_id=\"T1552\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1552xml.write("<search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory \"reg\" \"query\" \"password\" ")
        t1552xml.write("| stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1552xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1552xml.write("| search mitre_id=\"T1552\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1552xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1552xml.write("| search mitre_id=\"T1552\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1552xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1552xml.write("| search mitre_id=\"T1552\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1552xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1552xml.write("| search mitre_id=\"T1552\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1552xml.write("</panel>\n  </row>\n</form>")
  # Discovery
    with open(sd+"t1087.xml", "w") as t1087xml:
        t1087xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1087: Account Discovery</label>\n  ")
        t1087xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1087xml.write("| search mitre_id=\"T1087\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1087xml.write("<html depends=\"$it_tok$\" src=\"t1087.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1087xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1087xml.write("| search mitre_id=\"T1087\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1087xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1087xml.write("| search mitre_id=\"T1087\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1087xml.write("<title>Registry activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=registry | `MITRE_lookup` ")
        t1087xml.write("| search mitre_id=\"T1087\" RegistryKey=* | table index host mitre_id subid mitre_technique logtype Plugin AccountProfile RegistryHive RegistryKey CommandParameters</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1087xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1087xml.write("| search mitre_id=\"T1087\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1087xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1087xml.write("| search mitre_id=\"T1087\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1087xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1087xml.write("| search mitre_id=\"T1087\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1087xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1010.xml", "w") as t1010xml: # undetectable
        t1010xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1010: Application Window Discovery</label>\n  ")
        t1010xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1010xml.write("| search mitre_id=\"T1010\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1010xml.write("<html depends=\"$it_tok$\" src=\"t1010.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1217.xml", "w") as t1217xml:
        t1217xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1217: Browser Bookmark Discovery</label>\n  ")
        t1217xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1217xml.write("| search mitre_id=\"T1217\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1217xml.write("<html depends=\"$it_tok$\" src=\"t1217.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1217xml.write("<title>Browser activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=browser | `MITRE_lookup` ")
        t1217xml.write("| `browser_name` | `browser_domain` | table index host logtype LastWriteTime browser Domain url title Profile Protocol | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1217xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1580.xml", "w") as t1580xml: # out of scope
        t1580xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1580: Cloud Infrastructure Discovery</label>\n  ")
        t1580xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1580xml.write("| search mitre_id=\"T1580\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1580xml.write("<html depends=\"$it_tok$\" src=\"t1580.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1538.xml", "w") as t1538xml: # out of scope
        t1538xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1538: Cloud Service Dashboard</label>\n  ")
        t1538xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1538xml.write("| search mitre_id=\"T1538\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1538xml.write("<html depends=\"$it_tok$\" src=\"t1538.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1526.xml", "w") as t1526xml: # out of scope
        t1526xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1526: Cloud Service Discovery</label>\n  ")
        t1526xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1526xml.write("| search mitre_id=\"T1526\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1526xml.write("<html depends=\"$it_tok$\" src=\"t1526.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1613.xml", "w") as t1613xml: # out of scope
        t1613xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1613: Container and Resource Discovery</label>\n  ")
        t1613xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1613xml.write("| search mitre_id=\"T1613\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1613xml.write("<html depends=\"$it_tok$\" src=\"t1613.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1482.xml", "w") as t1482xml:
        t1482xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1482: Domain Trust Discovery</label>\n  ")
        t1482xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1482xml.write("| search mitre_id=\"T1482\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1482xml.write("<html depends=\"$it_tok$\" src=\"t1482.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1482xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1482xml.write("| search mitre_id=\"T1482\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1482xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1083.xml", "w") as t1083xml:
        t1083xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1083: File and Directory Discovery</label>\n  ")
        t1083xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1083xml.write("| search mitre_id=\"T1083\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1083xml.write("<html depends=\"$it_tok$\" src=\"t1083.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1083xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1083xml.write("| search mitre_id=\"T1083\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1083xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1083xml.write("| search mitre_id=\"T1083\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1083xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1083xml.write("| search mitre_id=\"T1083\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1083xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1046.xml", "w") as t1046xml: # undetectable
        t1046xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1046: Network Service Scanning</label>\n  ")
        t1046xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1046xml.write("| search mitre_id=\"T1046\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1046xml.write("<html depends=\"$it_tok$\" src=\"t1046.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1135.xml", "w") as t1135xml:
        t1135xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1135: Network Share Discovery</label>\n  ")
        t1135xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1135xml.write("| search mitre_id=\"T1135\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1135xml.write("<html depends=\"$it_tok$\" src=\"t1135.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1135xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1135xml.write("| search mitre_id=\"T1135\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1135xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1135xml.write("| search mitre_id=\"T1135\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1135xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1135xml.write("| search mitre_id=\"T1135\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1135xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1201.xml", "w") as t1201xml:
        t1201xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1201: Password Policy Discovery</label>\n  ")
        t1201xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1201xml.write("| search mitre_id=\"T1201\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1201xml.write("<html depends=\"$it_tok$\" src=\"t1201.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1201xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1201xml.write("| search mitre_id=\"T1201\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1201xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1201xml.write("| search mitre_id=\"T1201\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1201xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1201xml.write("| search mitre_id=\"T1201\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1201xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1201xml.write("| search mitre_id=\"T1201\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1201xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1120.xml", "w") as t1120xml:
        t1120xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1120: Peripheral Device Discovery</label>\n  ")
        t1120xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1120xml.write("| search mitre_id=\"T1120\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1120xml.write("<html depends=\"$it_tok$\" src=\"t1120.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1120xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1120xml.write("| search mitre_id=\"T1120\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1120xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1120xml.write("| search mitre_id=\"T1120\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1120xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1069.xml", "w") as t1069xml:
        t1069xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1069: Permission Groups Discovery</label>\n  ")
        t1069xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1069xml.write("| search mitre_id=\"T1069\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1069xml.write("<html depends=\"$it_tok$\" src=\"t1069.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1069xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1069xml.write("| search mitre_id=\"T1069\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1069xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1069xml.write("| search mitre_id=\"T1069\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1069xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1069xml.write("| search mitre_id=\"T1069\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1069xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1069xml.write("| search mitre_id=\"T1069\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1069xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1057.xml", "w") as t1057xml:
        t1057xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1057: Process Discovery</label>\n  ")
        t1057xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1057xml.write("| search mitre_id=\"T1057\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1057xml.write("<html depends=\"$it_tok$\" src=\"t1057.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1057xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1057xml.write("| search mitre_id=\"T1057\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1057xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1057xml.write("| search mitre_id=\"T1057\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1057xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1057xml.write("| search mitre_id=\"T1057\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1057xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1057xml.write("| search mitre_id=\"T1057\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1057xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1012.xml", "w") as t1012xml:
        t1012xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1012: Query Registry</label>\n  ")
        t1012xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1012xml.write("| search mitre_id=\"T1012\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1012xml.write("<html depends=\"$it_tok$\" src=\"t1012.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1012xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1012xml.write("| search mitre_id=\"T1012\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1012xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1018.xml", "w") as t1018xml:
        t1018xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1018: Remote System Discovery</label>\n  ")
        t1018xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1018xml.write("| search mitre_id=\"T1018\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1018xml.write("<html depends=\"$it_tok$\" src=\"t1018.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1018xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1018xml.write("| search mitre_id=\"T1018\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1018xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1018xml.write("| search mitre_id=\"T1018\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1018xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1018xml.write("| search mitre_id=\"T1018\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1018xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1018xml.write("| search mitre_id=\"T1018\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1018xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1018xml.write("| search mitre_id=\"T1018\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1018xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1518.xml", "w") as t1518xml:
        t1518xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1518: Software Discovery</label>\n  ")
        t1518xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1518xml.write("| search mitre_id=\"T1518\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1518xml.write("<html depends=\"$it_tok$\" src=\"t1518.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1518xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1518xml.write("| search mitre_id=\"T1518\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1518xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1518xml.write("| search mitre_id=\"T1518\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1518xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1518xml.write("| search mitre_id=\"T1518\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n        ")
        t1518xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1082.xml", "w") as t1082xml:
        t1082xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1082: System Information Discovery</label>\n  ")
        t1082xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1082xml.write("| search mitre_id=\"T1082\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1082xml.write("<html depends=\"$it_tok$\" src=\"t1082.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1082xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1082xml.write("| search mitre_id=\"T1082\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1082xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1082xml.write("| search mitre_id=\"T1082\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1082xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1082xml.write("| search mitre_id=\"T1082\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1082xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1614.xml", "w") as t1614xml:
        t1614xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1614: System Location Discovery</label>\n  ")
        t1614xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1614xml.write("| search mitre_id=\"T1614\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1614xml.write("<html depends=\"$it_tok$\" src=\"t1614.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1614xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1614xml.write("| search mitre_id=\"T1614\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1614xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1016.xml", "w") as t1016xml:
        t1016xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1016: System Network Configuration Discovery</label>\n  ")
        t1016xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1016xml.write("| search mitre_id=\"T1016\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1016xml.write("<html depends=\"$it_tok$\" src=\"t1016.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1016xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1016xml.write("| search mitre_id=\"T1016\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1016xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1016xml.write("| search mitre_id=\"T1016\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1016xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1016xml.write("| search mitre_id=\"T1016\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1016xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1049.xml", "w") as t1049xml:
        t1049xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1049: System Network Connections Discovery</label>\n  ")
        t1049xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1049xml.write("| search mitre_id=\"T1049\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1049xml.write("<html depends=\"$it_tok$\" src=\"t1049.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1049xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1049xml.write("| search mitre_id=\"T1049\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1049xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1049xml.write("| search mitre_id=\"T1049\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1049xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1049xml.write("| search mitre_id=\"T1049\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1049xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1049xml.write("| search mitre_id=\"T1049\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1049xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1033.xml", "w") as t1033xml:
        t1033xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1033: System Owner/User Discovery</label>\n  ")
        t1033xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1033xml.write("| search mitre_id=\"T1033\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1033xml.write("<html depends=\"$it_tok$\" src=\"t1033.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1033xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1033xml.write("| search mitre_id=\"T1033\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1033xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1033xml.write("| search mitre_id=\"T1033\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1033xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1007.xml", "w") as t1007xml:
        t1007xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1007: System Service Discovery</label>\n  ")
        t1007xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1007xml.write("| search mitre_id=\"T1007\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1007xml.write("<html depends=\"$it_tok$\" src=\"t1007.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1007xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1007xml.write("| search mitre_id=\"T1007\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1007xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1007xml.write("| search mitre_id=\"T1007\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1007xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1007xml.write("| search mitre_id=\"T1007\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1007xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1007xml.write("| search mitre_id=\"T1007\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1007xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1007xml.write("| search mitre_id=\"T1007\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1007xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1124.xml", "w") as t1124xml:
        t1124xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1124: System Time Discovery</label>\n  ")
        t1124xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1124xml.write("| search mitre_id=\"T1124\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1124xml.write("<html depends=\"$it_tok$\" src=\"t1124.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1124xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1124xml.write("| search mitre_id=\"T1124\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1124xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1124xml.write("| search mitre_id=\"T1124\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1124xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1124xml.write("| search mitre_id=\"T1124\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1124xml.write("</panel>\n  </row>\n</form>")
  # Lateral Movement
    with open(sd+"t1210.xml", "w") as t1210xml:
        t1210xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1210: Exploitation of Remote Services</label>\n  ")
        t1210xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1210xml.write("| search mitre_id=\"T1210\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1210xml.write("<html depends=\"$it_tok$\" src=\"t1210.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1210xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1210xml.write("| search mitre_id=\"T1210\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1210xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1534.xml", "w") as t1534xml: # undetectable
        t1534xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1534: Internal Spearphishing</label>\n  ")
        t1534xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1534xml.write("| search mitre_id=\"T1534\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1534xml.write("<html depends=\"$it_tok$\" src=\"t1534.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1570.xml", "w") as t1570xml:
        t1570xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1570: Lateral Tool Transfer</label>\n  ")
        t1570xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1570xml.write("| search mitre_id=\"T1570\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1570xml.write("<html depends=\"$it_tok$\" src=\"t1570.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1570xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1570xml.write("| search mitre_id=\"T1570\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1570xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1570xml.write("| search mitre_id=\"T1570\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n        ")
        t1570xml.write("\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1570xml.write("<title>Windows USB Connectivity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique=$mitre_tok$ `usb_out`</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1570xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1570xml.write("| search mitre_id=\"T1570\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1570xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1563.xml", "w") as t1563xml:
        t1563xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1563: Remote Service Session Hijacking</label>\n  ")
        t1563xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1563xml.write("| search mitre_id=\"T1563\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1563xml.write("<html depends=\"$it_tok$\" src=\"t1563.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1563xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1563xml.write("| search mitre_id=\"T1563\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1563xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1563xml.write("| search mitre_id=\"T1563\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1563xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1563xml.write("| search mitre_id=\"T1563\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1563xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1021.xml", "w") as t1021xml:
        t1021xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1021: Remote Services</label>\n  ")
        t1021xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1021xml.write("| search mitre_id=\"T1021\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1021xml.write("<html depends=\"$it_tok$\" src=\"t1021.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1021xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1021xml.write("| search mitre_id=\"T1021\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1021xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1021xml.write("| search mitre_id=\"T1021\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1021xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1080.xml", "w") as t1080xml: # undetectable
        t1080xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1080: Taint Shared Content</label>\n  ")
        t1080xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1080xml.write("| search mitre_id=\"T1080\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1080xml.write("<html depends=\"$it_tok$\" src=\"t1080.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
  # Collection
    with open(sd+"t1560.xml", "w") as t1560xml:
        t1560xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1560: Archive Collected Data</label>\n  ")
        t1560xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1560xml.write("| search mitre_id=\"T1560\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1560xml.write("<html depends=\"$it_tok$\" src=\"t1560.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1560xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1560xml.write("| search mitre_id=\"T1560\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1560xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1560xml.write("| search mitre_id=\"T1560\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1560xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1560xml.write("| search mitre_id=\"T1560\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1560xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1560xml.write("| search mitre_id=\"T1560\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1560xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1123.xml", "w") as t1123xml:
        t1123xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1123: Audio Capture</label>\n  ")
        t1123xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1123xml.write("| search mitre_id=\"T1123\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1123xml.write("<html depends=\"$it_tok$\" src=\"t1123.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1123xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1123xml.write("| search mitre_id=\"T1123\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1123xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1123xml.write("| search mitre_id=\"T1123\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1123xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1123xml.write("| search mitre_id=\"T1123\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1123xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1123xml.write("| search mitre_id=\"T1011\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1123xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1123xml.write("| search mitre_id=\"T1123\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1123xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1119.xml", "w") as t1119xml: # undetectable
        t1119xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1119: Automated Collection</label>\n  ")
        t1119xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1119xml.write("| search mitre_id=\"T1119\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1119xml.write("<html depends=\"$it_tok$\" src=\"t1119.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1115.xml", "w") as t1115xml:
        t1115xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1115: Clipboard Data</label>\n  ")
        t1115xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1115xml.write("| search mitre_id=\"T1115\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1115xml.write("<html depends=\"$it_tok$\" src=\"t1115.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1115xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1115xml.write("| search mitre_id=\"T1115\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1115xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1115xml.write("| search mitre_id=\"T1115\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1115xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1530.xml", "w") as t1530xml: # out of scope
        t1530xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1530: Data from Cloud Storage Object</label>\n  ")
        t1530xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1530xml.write("| search mitre_id=\"T1530\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1530xml.write("<html depends=\"$it_tok$\" src=\"t1530.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1602.xml", "w") as t1602xml: # out of scope
        t1602xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1602: Data from Configuration Repository</label>\n  ")
        t1602xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1602xml.write("| search mitre_id=\"T1602\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1602xml.write("<html depends=\"$it_tok$\" src=\"t1602.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1213.xml", "w") as t1213xml: # undetectable
        t1213xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1213: Data from Information Repositories</label>\n  ")
        t1213xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1213xml.write("| search mitre_id=\"T1213\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1213xml.write("<html depends=\"$it_tok$\" src=\"t1213.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1005.xml", "w") as t1005xml: # undetectable
        t1005xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1005: Data from Local System</label>\n  ")
        t1005xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1005xml.write("| search mitre_id=\"T1005\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1005xml.write("<html depends=\"$it_tok$\" src=\"t1005.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1039.xml", "w") as t1039xml: # undetectable
        t1039xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1039: Data from Network Shared Drive</label>\n  ")
        t1039xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1039xml.write("| search mitre_id=\"T1039\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1039xml.write("<html depends=\"$it_tok$\" src=\"t1039.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1025.xml", "w") as t1025xml:
        t1025xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1025: Data from Removable Media</label>\n  ")
        t1025xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1025xml.write("| search mitre_id=\"T1025\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1025xml.write("<html depends=\"$it_tok$\" src=\"t1025.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1025xml.write("<title>Windows USB Connectivity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique=$mitre_tok$ `usb_out`</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1025xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1074.xml", "w") as t1074xml: # undetectable
        t1074xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1074: Data Staged</label>\n  ")
        t1074xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1074xml.write("| search mitre_id=\"T1074\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1074xml.write("<html depends=\"$it_tok$\" src=\"t1074.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1114.xml", "w") as t1114xml:
        t1114xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1114: Email Collection</label>\n  ")
        t1114xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1114xml.write("| search mitre_id=\"T1114\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1114xml.write("<html depends=\"$it_tok$\" src=\"t1114.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1114xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1114xml.write("| search mitre_id=\"T1114\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1114xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1114xml.write("| search mitre_id=\"T1114\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1114xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1114xml.write("| search mitre_id=\"T1114\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1114xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1114xml.write("| search mitre_id=\"T1114\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1114xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1185.xml", "w") as t1185xml:
        t1185xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1185: Man in the Browser</label>\n  ")
        t1185xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1185xml.write("| search mitre_id=\"T1185\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1185xml.write("<html depends=\"$it_tok$\" src=\"t1185.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1185xml.write("<title>Browser activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=browser | `MITRE_lookup` ")
        t1185xml.write("| `browser_name` | `browser_domain` | table index host logtype LastWriteTime browser Domain url title Profile Protocol | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1185xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1113.xml", "w") as t1113xml:
        t1113xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1113: Screen Capture</label>\n  ")
        t1113xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1113xml.write("| search mitre_id=\"T1113\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1113xml.write("<html depends=\"$it_tok$\" src=\"t1113.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1113xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1113xml.write("| search mitre_id=\"T1113\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1113xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1113xml.write("| search mitre_id=\"T1113\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1113xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1113xml.write("| search mitre_id=\"T1113\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1113xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1113xml.write("| search mitre_id=\"T1113\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1113xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1125.xml", "w") as t1125xml:
        t1125xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1125: Video Capture</label>\n  ")
        t1125xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1125xml.write("| search mitre_id=\"T1125\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1125xml.write("<html depends=\"$it_tok$\" src=\"t1125.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1125xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1125xml.write("| search mitre_id=\"T1125\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1125xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1125xml.write("| search mitre_id=\"T1125\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1125xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1125xml.write("| search mitre_id=\"T1125\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1125xml.write("</panel>\n  </row>\n</form>")
  # Command and Control
    with open(sd+"t1071.xml", "w") as t1071xml:
        t1071xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1071: Application Layer Protocol</label>\n  ")
        t1071xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1071xml.write("| search mitre_id=\"T1071\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1071xml.write("<html depends=\"$it_tok$\" src=\"t1071.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1071xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1071xml.write("| search mitre_id=\"T1071\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1071xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1092.xml", "w") as t1092xml:
        t1092xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1092: Communication Through Removable Media</label>\n  ")
        t1092xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1092xml.write("| search mitre_id=\"T1092\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1092xml.write("<html depends=\"$it_tok$\" src=\"t1092.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1092xml.write("<title>Windows USB Connectivity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique=$mitre_tok$ `usb_out`</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1092xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1132.xml", "w") as t1132xml:
        t1132xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1132: Data Encoding</label>\n  ")
        t1132xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1132xml.write("| search mitre_id=\"T1132\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1132xml.write("<html depends=\"$it_tok$\" src=\"t1132.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1132xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1132xml.write("| search mitre_id=\"T1132\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1132xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1132xml.write("| search mitre_id=\"T1132\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1132xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1001.xml", "w") as t1001xml:
        t1001xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1001: Data Obfuscation</label>\n  ")
        t1001xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1001xml.write("| search mitre_id=\"T1001\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1001xml.write("<html depends=\"$it_tok$\" src=\"t1001.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1001xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1001xml.write("| search mitre_id=\"T1001\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1001xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1568.xml", "w") as t1568xml: # undetectable
        t1568xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1568: Dynamic Resolution</label>\n  ")
        t1568xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1568xml.write("| search mitre_id=\"T1568\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1568xml.write("<html depends=\"$it_tok$\" src=\"t1568.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1573.xml", "w") as t1573xml:
        t1573xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1573: Encrypted Channel</label>\n  ")
        t1573xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1573xml.write("| search mitre_id=\"T1573\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1573xml.write("<html depends=\"$it_tok$\" src=\"t1573.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1573xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1573xml.write("| search mitre_id=\"T1573\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1573xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1573xml.write("| search mitre_id=\"T1573\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1573xml.write("<title>Browser activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=browser | `MITRE_lookup` ")
        t1573xml.write("| `browser_name` | `browser_domain` | table index host logtype LastWriteTime browser Domain url title Profile Protocol | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1573xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1008.xml", "w") as t1008xml: # undetectable
        t1008xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1008: Fallback Channels</label>\n  ")
        t1008xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1008xml.write("| search mitre_id=\"T1008\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1008xml.write("<html depends=\"$it_tok$\" src=\"t1008.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1105.xml", "w") as t1105xml:
        t1105xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1105: Ingress Tool Transfer</label>\n  ")
        t1105xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1105xml.write("| search mitre_id=\"T1105\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1105xml.write("<html depends=\"$it_tok$\" src=\"t1105.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1105xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1105xml.write("| search mitre_id=\"T1105\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1105xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1105xml.write("| search mitre_id=\"T1105\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1105xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1105xml.write("| search mitre_id=\"T1105\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1105xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1104.xml", "w") as t1104xml: # undetectable
        t1104xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1104: Multi-Stage Channels</label>\n  ")
        t1104xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1104xml.write("| search mitre_id=\"T1104\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1104xml.write("<html depends=\"$it_tok$\" src=\"t1104.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1095.xml", "w") as t1095xml: # undetectable
        t1095xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1095: Non-Application Layer Protocol</label>\n  ")
        t1095xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1095xml.write("| search mitre_id=\"T1095\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1095xml.write("<html depends=\"$it_tok$\" src=\"t1095.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1095xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1095xml.write("| search mitre_id=\"T1095\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1095xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1571.xml", "w") as t1571xml:
        t1571xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1571: Non-Standard Port</label>\n  ")
        t1571xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1571xml.write("| search mitre_id=\"T1571\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1571xml.write("<html depends=\"$it_tok$\" src=\"t1571.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1571xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1571xml.write("| search mitre_id=\"T1571\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1571xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1572.xml", "w") as t1572xml: # undetectable
        t1572xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1572: Protocol Tunneling</label>\n  ")
        t1572xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1572xml.write("| search mitre_id=\"T1572\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1572xml.write("<html depends=\"$it_tok$\" src=\"t1572.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1090.xml", "w") as t1090xml:
        t1090xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1090: Proxy</label>\n  ")
        t1090xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1090xml.write("| search mitre_id=\"T1090\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1090xml.write("<html depends=\"$it_tok$\" src=\"t1090.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1090xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1090xml.write("| search mitre_id=\"T1090\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1090xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1090xml.write("| search mitre_id=\"T1090\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1090xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1219.xml", "w") as t1219xml:
        t1219xml.write("  <form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1219: Remote Access Software</label>\n  ")
        t1219xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1219xml.write("| search mitre_id=\"T1546\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1219xml.write("<html depends=\"$it_tok$\" src=\"t1219.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1219xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1219xml.write("| search mitre_id=\"T1219\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1219xml.write("\n    </panel>\n  </row>\n</form>")
    with open(sd+"t1102.xml", "w") as t1102xml: # undetectable
        t1102xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1102: Web Service</label>\n  ")
        t1102xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1102xml.write("| search mitre_id=\"T1102\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1102xml.write("<html depends=\"$it_tok$\" src=\"t1102.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
  # Exfiltration
    with open(sd+"t1020.xml", "w") as t1020xml: # undetectable
        t1020xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1020: Automated Exfiltration</label>\n  ")
        t1020xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1020xml.write("| search mitre_id=\"T1020\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1020xml.write("<html depends=\"$it_tok$\" src=\"t1020.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1030.xml", "w") as t1030xml: # undetectable
        t1030xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1030: Data Transfer Size Limits</label>\n  ")
        t1030xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1030xml.write("| search mitre_id=\"T1030\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1030xml.write("<html depends=\"$it_tok$\" src=\"t1030.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1048.xml", "w") as t1048xml:
        t1048xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1048: Exfiltration Over Alternative Protocol</label>\n  ")
        t1048xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1048xml.write("<html depends=\"$it_tok$\" src=\"t1048.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1048xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=memory `non-standard_ports` ")
        t1048xml.write("| stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1048xml.write("<title>Browser activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=browser ")
        t1048xml.write("| `browser_name` | `browser_domain` | table index host logtype LastWriteTime browser Domain url title Profile Protocol | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1048xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1041.xml", "w") as t1041xml:
        t1041xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1041: Exfiltration Over C2 Channel</label>\n  ")
        t1041xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1041xml.write("| search mitre_id=\"T1041\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1041xml.write("<html depends=\"$it_tok$\" src=\"t1041.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1041xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1041xml.write("| search mitre_id=\"T1041\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1041xml.write("<title>Browser activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=browser | `MITRE_lookup` ")
        t1041xml.write("| `browser_name` | `browser_domain` | table index host logtype LastWriteTime browser Domain url title Profile Protocol | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1041xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1011.xml", "w") as t1011xml:
        t1011xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1011: Exfiltration Over Other Network Medium</label>\n  ")
        t1011xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1011xml.write("| search mitre_id=\"T1011\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1011xml.write("<html depends=\"$it_tok$\" src=\"t1011.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1011xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1011xml.write("| search mitre_id=\"T1011\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1011xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1011xml.write("| search mitre_id=\"T1011\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1011xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1011xml.write("| search mitre_id=\"T1011\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1011xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1011xml.write("| search mitre_id=\"T1011\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1011xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1052.xml", "w") as t1052xml:
        t1052xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1052: Exfiltration Over Physical Medium</label>\n  ")
        t1052xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1052xml.write("| search mitre_id=\"T1052\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1052xml.write("<html depends=\"$it_tok$\" src=\"t1052.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1052xml.write("<title>Windows USB Connectivity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique=$mitre_tok$ `usb_out`</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1052xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1567.xml", "w") as t1567xml:
        t1567xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1567: Exfiltration Over Web Service</label>\n  ")
        t1567xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1567xml.write("| search mitre_id=\"T1567\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1567xml.write("<html depends=\"$it_tok$\" src=\"t1567.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1567xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1567xml.write("| search mitre_id=\"T1567\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1567xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1567xml.write("| search mitre_id=\"T1567\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1567xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1567xml.write("| search mitre_id=\"T1567\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1567xml.write("<title>Browser activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=browser | `MITRE_lookup` ")
        t1567xml.write("| `browser_name` | `browser_domain` | table index host logtype LastWriteTime browser Domain url title Profile Protocol | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1567xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1567xml.write("| search mitre_id=\"T1567\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1567xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1029.xml", "w") as t1029xml: # undetectable
        t1029xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1029: Scheduled Transfer</label>\n  ")
        t1029xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1029xml.write("| search mitre_id=\"T1029\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1029xml.write("<html depends=\"$it_tok$\" src=\"t1029.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1537.xml", "w") as t1537xml:
        t1537xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1537: Transfer Data to Cloud Account</label>\n  ")
        t1537xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1537xml.write("| search mitre_id=\"T1537\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1537xml.write("<html depends=\"$it_tok$\" src=\"t1537.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1537xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory `standard_ports` | `MITRE_lookup` ")
        t1537xml.write("| search mitre_id=\"T1537\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1537xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1537xml.write("| search mitre_id=\"T1537\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1537xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1537xml.write("| search mitre_id=\"T1537\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1537xml.write("<title>Registry activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=registry | `MITRE_lookup` ")
        t1537xml.write("| search mitre_id=\"T1537\" RegistryKey=* | table index host mitre_id subid mitre_technique logtype Plugin AccountProfile RegistryHive RegistryKey CommandParameters</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1537xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1537xml.write("| search mitre_id=\"T1537\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>0</earliest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1537xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1537xml.write("| search mitre_id=\"T1537\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1537xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1537xml.write("| search mitre_id=\"T1537\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1537xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1537xml.write("| search mitre_id=\"T1537\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n      ")
        t1537xml.write("<title>Browser activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ logtype=browser (onedrive OR 1drv OR azure OR icloud OR cloudrive OR dropbox OR \"drive.google\" OR fileshare OR mediafire OR zippyshare OR megaupload) ")
        t1537xml.write("| `browser_name` | `browser_domain` | table index host logtype LastWriteTime browser Domain url title Profile Protocol | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1537xml.write("</panel>\n  </row>\n</form>")
  # Impact
    with open(sd+"t1531.xml", "w") as t1531xml:
        t1531xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1531: Account Access Removal</label>\n  ")
        t1531xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1531xml.write("| search mitre_id=\"T1531\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1531xml.write("<html depends=\"$it_tok$\" src=\"t1531.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1531xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1531xml.write("| search mitre_id=\"T1531\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1531xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1531xml.write("| search mitre_id=\"T1531\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1531xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1485.xml", "w") as t1485xml:
        t1485xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1485: Data Destruction</label>\n  ")
        t1485xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1485xml.write("| search mitre_id=\"T1485\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1485xml.write("<html depends=\"$it_tok$\" src=\"t1485.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1485xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1485xml.write("| search mitre_id=\"T1485\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1485xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1485xml.write("| search mitre_id=\"T1485\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1485xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1485xml.write("| search mitre_id=\"T1485\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1485xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1485xml.write("| search mitre_id=\"T1485\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1485xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1485xml.write("| search mitre_id=\"T1485\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1485xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1486.xml", "w") as t1486xml: # undetectable
        t1486xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1486: Data Encrypted for Impact</label>\n  ")
        t1486xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1486xml.write("| search mitre_id=\"T1486\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1486xml.write("<html depends=\"$it_tok$\" src=\"t1486.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1565.xml", "w") as t1565xml: # undetectable
        t1565xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1565: Data Manipulation</label>\n  ")
        t1565xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1565xml.write("| search mitre_id=\"T1565\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1565xml.write("<html depends=\"$it_tok$\" src=\"t1565.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1491.xml", "w") as t1491xml: # undetectable
        t1491xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1491: Defacement</label>\n  ")
        t1491xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1491xml.write("| search mitre_id=\"T1491\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1491xml.write("<html depends=\"$it_tok$\" src=\"t1491.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1561.xml", "w") as t1561xml: # undetectable
        t1561xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1561: Disk Wipe</label>\n  ")
        t1561xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1561xml.write("| search mitre_id=\"T1561\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1561xml.write("<html depends=\"$it_tok$\" src=\"t1561.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1499.xml", "w") as t1499xml: # undetectable
        t1499xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1499: Endpoint Denial of Service</label>\n  ")
        t1499xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1499xml.write("| search mitre_id=\"T1499\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1499xml.write("<html depends=\"$it_tok$\" src=\"t1499.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1495.xml", "w") as t1495xml: # undetectable
        t1495xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1495: Firmware Corruption</label>\n  ")
        t1495xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1495xml.write("| search mitre_id=\"T1495\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1495xml.write("<html depends=\"$it_tok$\" src=\"t1495.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1490.xml", "w") as t1490xml:
        t1490xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1490: Inhibit System Recovery</label>\n  ")
        t1490xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1490xml.write("| search mitre_id=\"T1490\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1490xml.write("<html depends=\"$it_tok$\" src=\"t1490.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1490xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1490xml.write("| search mitre_id=\"T1490\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1490xml.write("<title>Registry activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=registry | `MITRE_lookup` ")
        t1490xml.write("| search mitre_id=\"T1490\" RegistryKey=* | table index host mitre_id subid mitre_technique logtype Plugin AccountProfile RegistryHive RegistryKey CommandParameters</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1490xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1490xml.write("| search mitre_id=\"T1490\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1490xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1490xml.write("| search mitre_id=\"T1490\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1490xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1498.xml", "w") as t1498xml: # no events available
        t1498xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1498: Network Denial of Service</label>\n  ")
        t1498xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1498xml.write("| search mitre_id=\"T1498\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1498xml.write("<html depends=\"$it_tok$\" src=\"t1498.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1496.xml", "w") as t1496xml: # no events available
        t1496xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1496: Resource Hijacking</label>\n  ")
        t1496xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1496xml.write("| search mitre_id=\"T1496\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1496xml.write("<html depends=\"$it_tok$\" src=\"t1496.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <html src=\"na.html\"/>\n    </panel>\n  </row>\n</form>\n")
    with open(sd+"t1489.xml", "w") as t1489xml:
        t1489xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1486: Service Stop</label>\n  ")
        t1489xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1489xml.write("| search mitre_id=\"T1489\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1489xml.write("<html depends=\"$it_tok$\" src=\"t1489.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1489xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1489xml.write("| search mitre_id=\"T1489\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1489xml.write("<title>Windows-based file activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=MFT | `MITRE_lookup` ")
        t1489xml.write("| search mitre_id=\"T1489\" | `merge_fileinfo` | table index host mitre_id subid mitre_technique LastWriteTime Filepath Filename Fileext</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1489xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1489xml.write("| search mitre_id=\"T1489\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1489xml.write("<title>ShimCache activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=ShimCache | `MITRE_lookup` ")
        t1489xml.write("| search mitre_id=\"T1489\" | table index host mitre_id subid mitre_technique LastWriteTime ProcessPath ProcessName</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1489xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1489xml.write("| search mitre_id=\"T1489\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1489xml.write("<title>Unix service activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=service | `MITRE_lookup` ")
        t1489xml.write("| search mitre_id=\"T1489\" | table index host mitre_id subid mitre_technique logtype BusName Service ExecStart Description | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n      <table>\n        ")
        t1489xml.write("<title>Plist entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=plist | `MITRE_lookup` ")
        t1489xml.write("| search mitre_id=\"T1489\" | table index host mitre_id subid mitre_technique Plist KeepAlive POSIXSpawnType \"ProgramArguments{}\"</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1489xml.write("<title>Audit file entries</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=audit | `MITRE_lookup` ")
        t1489xml.write("| search mitre_id=\"T1489\" | `audit_assignments` | table index host mitre_id subid mitre_technique audit_file LastAccessTime Filename Filesize Entropy SHA256 | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    ")
        t1489xml.write("</panel>\n  </row>\n</form>")
    with open(sd+"t1529.xml", "w") as t1529xml:
        t1529xml.write("<form stylesheet=\"mitre.css\" theme=\"dark\">\n  <label>T1529: System Shutdown/Reboot</label>\n  ")
        t1529xml.write("<search id=\"base\">\n    <query>index=* | dedup index | search index=$case_tok$ host=$host_tok$ | table index host</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"mitre_base\">\n    <query>index=$case_tok$ host=$host_tok$ mitre_technique!=-</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <search id=\"dash\">\n    <query>| rest /servicesNS/-/-/data/ui/views | search \"eai:acl.app\"=elrond label=T*</query>\n    <earliest>$time_tok.earliest$</earliest>\n    <latest>$time_tok.latest$</latest>\n  </search>\n  <fieldset submitButton=\"false\">\n    <input type=\"checkbox\" token=\"it_tok\">\n      <label></label>\n      <populatingSearch fieldForLabel=\"it\" fieldForValue=\"it\">| gentimes start=-1 | eval it=\"Toggle MITRE Information\"</populatingSearch>\n    </input>\n    <input type=\"dropdown\" token=\"case_tok\" searchWhenChanged=\"true\">\n      <label>Select a Case:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>index</fieldForLabel>\n      <fieldForValue>index</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup index | sort index</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"host_tok\" searchWhenChanged=\"true\">\n      <label>Select a Host:</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <initialValue>*</initialValue>\n      <fieldForLabel>host</fieldForLabel>\n      <fieldForValue>host</fieldForValue>\n      <search base=\"base\">\n        <query>| dedup host | sort host</query>\n      </search>\n    </input>\n    <input type=\"dropdown\" token=\"mitre_tok\" searchWhenChanged=\"true\">\n      <label>Select MITRE Technique:</label>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>mitre_technique</fieldForLabel>\n      <fieldForValue>mitre_technique</fieldForValue>\n      <search base=\"mitre_base\">\n        <query>| `MITRE_lookup` ")
        t1529xml.write("| search mitre_id=\"T1529\" | stats count BY subid mitre_technique | sort sub_id | fields - subid</query>\n      </search>\n      <default>*</default>\n      <prefix>\"*</prefix>\n      <suffix>\"</suffix>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"time\" token=\"time_tok\" searchWhenChanged=\"true\">\n      <label>Select a Time Range:</label>\n      <default>\n        <earliest>-7d@h</earliest>\n        <latest></latest>\n      </default>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      ")
        t1529xml.write("<html depends=\"$it_tok$\" src=\"t1529.html\"/>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1529xml.write("<title>Volatile activity in memory</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=memory | `MITRE_lookup` ")
        t1529xml.write("| search mitre_id=\"T1529\" | stats count values(LocalAddress) AS LocalAddresses values(ForeignAddress) AS ForeignAddresses BY host ProcessName PID LocalPort ForeignPort Protocol State | sort -count | table host ProcessName PID LocalAddresses LocalPort ForeignAddresses ForeignPort Protocol State count</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1529xml.write("<title>Windows event log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=evt | `MITRE_lookup` ")
        t1529xml.write("| search mitre_id=\"T1529\" | eval TargetSids=mvappend(TargetSid,TargetUserSid) | table SystemTime host Computer Channel EventID LogonType SubjectUserName SubjectUserSid DisplayName WorkstationName TargetSids</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        ")
        t1529xml.write("<title>Unix log activity</title>\n        <search>\n          <query>index=$case_tok$ host=$host_tok$ mitre_technique!=- mitre_technique=$mitre_tok$ logtype=log | `MITRE_lookup` ")
        t1529xml.write("| search mitre_id=\"T1529\" | table index host mitre_id subid mitre_technique logtype DateTime Device Service PID Message | fillnull value=-</query>\n          <earliest>$time_tok.earliest$</earliest>\n          <latest>$time_tok.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">5</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    ")
        t1529xml.write("</panel>\n  </row>\n</form>")
